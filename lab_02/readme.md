Warning: тут плохо работает и говнокод. Лучше посмотрите другие реализации
